<!doctype html>
<html lang="fa-IR">
<head>
  <meta charset="utf-8">
  <title>هضم</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="../images/favicon.png"/>
  <!-- external css -->
  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <!-- my css -->
  <link rel="stylesheet" href="../fonts/font_face.css">
  <link rel="stylesheet" href="../css/highlight_code.css">
  <link rel="stylesheet" href="../css/donation_modal.css">
  <link rel="stylesheet" href="../css/demo.css">
</head>


<body>
<!------------------------- header section -------------------------->
<div class="header-container">
  <div class="header my-container">
    <h1 class="logo">هضم</h1>
    <span class="text">برای پردازش زبان فارسی</span>
    <img class="menu-icon active" src="../images/menu/mobile/menu.svg" alt="menu icon">
    <img class="close-icon" src="../images/menu/mobile/close.svg" alt="close icon">
    <div class="menu">
      <a href="#" class="donate-link item1">
        <img src="../images/menu/web/support_icon.svg" alt="support icon">
        <span>حمایت از پروژه</span>
      </a>
      <a href="#" class="item2">
        <img src="../images/menu/web/demo_icon.svg" alt="demoIcon">
        <span>اجرای نمونه</span>
      </a>
      <a href="https://github.com/sobhe/hazm" class="item3">
        <img src="../images/menu/web/git_icon.svg" alt="git_icon">
        <span>گیت هاب</span>
      </a>
      <a href="https://www.roshan-ai.ir/jobs/" class="item4">
        <img src="../images/menu/web/join_us_icon.svg" alt="joinUsIcon">
        <span>فرصت همکاری</span>
      </a>
    </div>
  </div>
</div>
<div class="line" style="display: none"></div>
<div class="mobile-menu" style="display: none">
  <ul class="my-container">
    <li class="item1">
      <a href="#">
        <img src="../images/menu/mobile/demo_icon.svg" alt="demoIcon">
        <span>اجرای نمونه</span>
      </a>
    </li>
    <li class="item2">
      <a href="https://github.com/sobhe/hazm">
        <img src="../images/menu/mobile/git_icon.svg" alt="git_icon">
        <span>گیت هاب</span>
      </a>
    </li>
    <li class="item3">
      <a href="#" class="donate-link">
        <img src="../images/menu/mobile/support_icon.svg" alt="support icon">
        <span>حمایت از پروژه</span>
      </a>
    </li>
    <li class="item4">
      <a href="https://www.roshan-ai.ir/jobs/">
        <img src="../images/menu/mobile/join_us_icon.svg" alt="joinUsIcon">
        <span>فرصت همکاری</span>
      </a>
    </li>
  </ul>
</div>

<!------------------------- content section -------------------------->
<div class="content my-container">
  <div id="query">
    <label for="textarea">متن ورودی</label>
    <textarea id="textarea">در می‌زند و دوباره وارد ميشود . همه مي گویند قدمش پربرکت است .</textarea>
    <div class="controls">
      <button id="process" class="my-btn blue-btn">پردازش</button>
      <button id="tag" class="my-btn green-btn" style="display: none">تحلیل صرفی</button>
      <button id="parse" class="my-btn red-btn" style="display: none">تجزیه نحوی</button>
      <span class="loading"></span>
    </div>
  </div>
  <div class="analyze-section" style="display: none">
    <div class="demo has-text" id="normalized">
      <h3>متن تمیز</h3>
      <div></div>
    </div>
    <div class="demo has-text" id="corrected">
      <h3>
        متن اصلاح‌شده
        <span class="info glyphicon glyphicon-plus-sign"
              data-toggle="tooltip"
              data-placement="left"
              title="این ابزار به صورت متن‌باز ارائه نشده است. برای استفاده، لطفا تماس بگیرید.">
        </span>
      </h3>
      <div></div>
    </div>
    <div class="demo has-li" id="tokenized">
      <h3>واژه‌های متن</h3>
      <div></div>
    </div>
    <div class="demo has-li" id="lemmatized">
      <h3>ریشه واژه‌ها</h3>
      <div></div>
    </div>
    <div class="demo has-li" id="tagged">
      <h3 class="green-title">تحلیل صرفی</h3>
      <div></div>
    </div>
    <div class="demo has-li" id="chunked">
      <h3 class="red-title">تجزیه سطحی</h3>
      <div></div>
    </div>
    <div class="demo has-li" id="parsed">
      <h3 class="red-title">تجزیه نحوی</h3>
      <div></div>
    </div>
  </div>
</div>

<!------------------------- footer section -------------------------->
<div class="footer my-container">
  <p>کاری از <a href="https://www.roshan-ai.ir">روشن</a></p>
</div>


<script type="text/javascript" src="../js/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://www.sobhe.ir/dependency-parse-tree/d3.js"></script>
<script type="text/javascript" src="https://www.sobhe.ir/dependency-parse-tree/dependency-tree.js"></script>

<!-- My Js-->
<script type="text/javascript">
  var server = 'https://hazm.sobhe.ir/api';
  var analyze_section = $(".analyze-section");
  var normalized = $('#normalized');
  var lemmatized = $('#lemmatized');
  var corrected = $('#corrected');
  var tokenized = $('#tokenized');
  var tagged = $('#tagged');
  var chunked = $('#chunked');
  var parsed = $('#parsed');

  var normalize = function (data) {
    $.post(server + '/normalize', data)
        .done(function (normalized_text) {
          analyze_section.show();
          normalized.show().find('div').text(normalized_text);
          normalized.addClass('added-data');
          tokenize({'normalized_text': normalized_text});
          correct({'text': data['text'], 'mode': 'cleaner'});
        })
  };
  var correct = function (data) {
    $.post(server + '/correct', data)
        .done(function (corrected_text) {
          corrected.show().find('div').text(corrected_text);
          corrected.addClass('added-data')
        })
  };
  var tokenize = function (data) {
    $.post(server + '/tokenize', data)
        .done(function (tokenized_text) {
          lemmatize({'tokenized_text': tokenized_text});
          $('#tag').attr('tokenized_text', tokenized_text).show();
          sentences = $.parseJSON(tokenized_text);
          tokenized.show().find('div').empty();
          for (s in sentences) {
            $('#tokenized div').append('<li>' + sentences[s].join(' ') + '</li>');
          }
          tokenized.addClass('added-data')
        })
        .always(hideLoading);
  };
  var lemmatize = function (data) {
    $.post(server + '/lemmatize', data)
        .done(function (lemmatized_text) {
          sentences = $.parseJSON(lemmatized_text);
          lemmatized.show().find('div').empty();
          for (s in sentences) {
            $('#lemmatized div').append('<li>' + sentences[s].join(' ') + '</li>');
          }
          lemmatized.addClass('added-data')
        });
  };
  var tag = function (data) {
    $.post(server + '/tag', data)
        .done(function (tagged_text) {
          lemmatize({'tagged_text': tagged_text});
          $('#tag').hide();
          $('#parse').attr('tagged_text', tagged_text).show();
          sentences = $.parseJSON(tagged_text);
          tagged.show().find('div').empty();
          for (s in sentences) {
            sentence = $.map(sentences[s], function (word) {
              return word.join('/');
            });
            $('#tagged div').append('<li>' + sentence.join(' ') + '</li>');
          }
          tagged.addClass('added-data')
        })
        .always(hideLoading);
  };
  var chunk = function (data) {
    $.post(server + '/chunk', data)
        .done(function (chunked_text) {
          sentences = $.parseJSON(chunked_text);
          chunked.show().find('div').empty();
          for (s in sentences) {
            $('#chunked div').append('<li>' + sentences[s] + '</li>');
          }
          chunked.addClass('added-data')
        });
  };
  var parse = function (data) {
    $.post(server + '/parse', data)
        .done(function (parsed_text) {
          $('#parse').hide();
          sentences = $.parseJSON(parsed_text);
          div = $('#parsed > div');
          div.empty();
          for (s in sentences) {
            // div.append('<li>' + sentences[s] + '</li>');
            if (sentences[s].length) {
              div.append('<div class="tree"><svg id="tree' + s + '"></svg></div>');
              drawTree('#tree' + s, sentences[s].replace(/_/g, ' '));
            }
          }
          parsed.show();
          parsed.addClass('added-data')
        })
        .always(hideLoading);
  };

  var hideLoading = function () {
    $('#query .my-btn').removeAttr('disabled');
    $('#query .loading').hide();
  };
  var showLoading = function () {
    $('#query .loading').css('display', 'inline-block');
    $('#query .my-btn').attr('disabled', 'disabled');
  };

  $('#process').click(function () {
    $('.demo, #tag, #parse').hide();
    var text = $('#query textarea').val();
    if (text) {
      normalize({text});
      showLoading();
    }
  });
  $('#tag').click(function () {
    tag({'tokenized_text': $(this).attr('tokenized_text')});
    showLoading();
  });
  $('#parse').click(function () {
    chunk({'tagged_text': $(this).attr('tagged_text')});
    parse({'tagged_text': $(this).attr('tagged_text')});
    showLoading();
  });
</script>
<script type="text/javascript">
  (function (e, t) {
    var n = e.amplitude || {_q: [], _iq: {}};
    var r = t.createElement("script");
    r.type = "text/javascript";
    r.integrity = "sha384-RsEu4WZflrqYcEacpfoGSib3qaSvdYwT4D+DrWqeBuDarSzjwUQR1jO8gDiXZd0E";
    r.crossOrigin = "anonymous";
    r.async = true;
    r.src = "https://cdn.amplitude.com/libs/amplitude-6.2.0-min.gz.js";
    r.onload = function () {
      if (!e.amplitude.runQueuedFunctions) {
        console.log("[Amplitude] Error: could not load SDK")
      }
    };
    var i = t.getElementsByTagName("script")[0];
    i.parentNode.insertBefore(r, i);

    function s(e, t) {
      e.prototype[t] = function () {
        this._q.push([t].concat(Array.prototype.slice.call(arguments, 0)));
        return this
      }
    }

    var o = function () {
      this._q = [];
      return this
    };
    var a = ["add", "append", "clearAll", "prepend", "set", "setOnce", "unset"];
    for (var u = 0; u < a.length; u++) {
      s(o, a[u])
    }
    n.Identify = o;
    var c = function () {
      this._q = [];
      return this
    };
    var l = ["setProductId", "setQuantity", "setPrice", "setRevenueType", "setEventProperties"];
    for (var p = 0; p < l.length; p++) {
      s(c, l[p])
    }
    n.Revenue = c;
    var d = ["init", "logEvent", "logRevenue", "setUserId", "setUserProperties", "setOptOut", "setVersionName", "setDomain", "setDeviceId", "enableTracking", "setGlobalUserProperties", "identify", "clearUserProperties", "setGroup", "logRevenueV2", "regenerateDeviceId", "groupIdentify", "onInit", "logEventWithTimestamp", "logEventWithGroups", "setSessionId", "resetSessionId"];

    function v(e) {
      function t(t) {
        e[t] = function () {
          e._q.push([t].concat(Array.prototype.slice.call(arguments, 0)))
        }
      }

      for (var n = 0; n < d.length; n++) {
        t(d[n])
      }
    }

    v(n);
    n.getInstance = function (e) {
      e = (!e || e.length === 0 ? "$default_instance" : e).toLowerCase();
      if (!n._iq.hasOwnProperty(e)) {
        n._iq[e] = {_q: []};
        v(n._iq[e])
      }
      return n._iq[e]
    };
    e.amplitude = n
  })(window, document);
  amplitude.getInstance().init("a113f04bf0c7f77d3803dfabd7877032");
</script>
<script type="text/javascript">
  $(function () {
    $('[data-toggle="tooltip"]').tooltip();
  });

  $('.donate-link').click(function () {
    amplitude.getInstance().logEvent('Hazm Donate');
  });

  amplitude.getInstance().logEvent('Hazm Demo');
</script>
<script type="text/javascript">
  $(document).ready(function () {
    const menu = $(".menu-icon");
    const close = $(".close-icon");
    const mobile_menu = $(".mobile-menu");
    const line = $(".line");

    menu.on('click', function () {
      menu.removeClass('active');
      close.addClass('active');
      mobile_menu.show();
      line.show()
    });

    close.on('click', function () {
      close.removeClass('active');
      menu.addClass('active');
      mobile_menu.hide();
      line.hide()
    });

    $('.logo').click(function () {
      window.location.href = "../"
    })
  });
</script>
<script type="text/javascript" src="../js/donation_modal.js"></script>
</body>
</html>
